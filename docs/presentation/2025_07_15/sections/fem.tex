\begin{frame}[allowframebreaks]{Discrete weak formulation}	
	Find $U_h=(\bm{u}_h, p_h, T_h) \in [V_h^{\, 0}]^2 \times Q_h \times W_h$ s.t., $\forall (\bm{v}_h, q_h, w_h) \in [V_h^{\, 0}]^2 \times Q_h \times W_h^{\, 0}$,

	\vspace{-4pt}
	\footnotesize
	\begin{equation}
		\label{eq:weak_pb}
		\begin{aligned}
			&\int_\Omega (\bm{u}_h \cdot \nabla)\bm{u}_h \cdot \bm{v}_h \, dx + \mu \int_\Omega \nabla \bm{u}_h : \nabla \bm{v}_h \, dx \\
			&\hspace{50pt} - \int_\Omega p_h \, \nabla \cdot \bm{v}_h \, dx - g \int_\Omega (1 + \beta T_h) \bm{e}_y \cdot \bm{v}_h \, dx = 0 \qquad\text{\footnotesize (momentum)} \\
			&\int_\Omega q_h \, \nabla \cdot \bm{u}_h \, dx + 10^{-4} \int_\Omega q_h \, p_h \, dx = 0 \qquad\text{\footnotesize (incompressibility + pressure penalization)}\\
			&\int_\Omega (\bm{u}_h \cdot \nabla T_h) \, w_h \, dx + \int_\Omega k_f \nabla T_h \cdot \nabla w_h \, dx = 0  \qquad\text{\footnotesize (energy)}
			% \epsilon \int_\Omega q \, p \, dx = 0
		\end{aligned}
		\tag{$\mathcal{P}_h$}
	\end{equation}

	% \vspace{-65pt}
	% \begin{flushright}
	% 	\footnotesize(momentum)
	% \end{flushright}

	% \vspace{50pt}
	\normalsize
	with 

	\vspace{-15pt}
	\begin{center}
		\begin{tabular}{ccccccccl}
		\uncover<0>{\footnotesize \big(dim$(V_h^{\, 0})=N_u$\big)} \qquad & $\bm{u}_h$ & $\in$ & $[V_h^{\, 0}]^2$ & $\subset$ & $[H^1_0(\Omega)]^2$ & : & $\mathbb{P}_2$ & \multirow{2}{*}{$\left. \rule{0pt}{1.7em} \right\} \;$ \footnotesize (Taylorâ€“Hood spaces)} \\
		\uncover<0>{\footnotesize \big(dim$(Q_h)=N_p$\big)} \qquad & $p_h$ & $\in$ & $Q_h$ & $\subset$ & $L^2_0(\Omega)$ & : & $ \mathbb{P}_1$ & \\ 
		\uncover<0>{\footnotesize \big(dim$(W_h)=N_T$\big)} \qquad & $T_h$ & $\in$ & $W_h$ & $\subset$ & $W$ & : & $\mathbb{P}_1$ & 
		\end{tabular}
	\end{center}

	and
	$$W = \{w\in H^1(\Omega), \; w\vert_{x=-1}=1, \; w\vert_{x=1}=-1\}.$$

	\newpage

	Considering $(\phi_i)_{i=1}^{N_u}$, $(\psi_j)_{j=1}^{N_p}$ and $(\eta_k)_{k=1}^{N_T}$ the basis functions of the finite element spaces $V_h^{\, 0}$, $Q_h$ and $W_h$ respectively, we can write the discrete solutions as:
	\begin{equation*}
		\bm{u}_h(\bm{x}) = \sum_{i=1}^{N_u} \begin{pmatrix}
			u_i \\
			v_i
		\end{pmatrix} \phi_i(\bm{x}), \quad p_h(\bm{x}) = \sum_{j=1}^{N_p} p_j \psi_j(\bm{x}) \quad \text{and} \quad T_h(\bm{x}) = \sum_{k=1}^{N_T} T_k \eta_k(\bm{x}),
	\end{equation*}	
	with the unknown vectors for velocity, pressure and temperature defined by

	\vspace{-5pt}
	$$\vec{u} = \big(u_i\big)_{i=1}^{N_u} \in \mathbb{R}^{N_u}, \quad \vec{v} = \big(v_i\big)_{i=1}^{N_u} \in \mathbb{R}^{N_u},$$
	% \vec{\bm{u}} = \big(\bm{u}_i\big)_{i=1}^{N_u} = \big((u_i,v_i)\big)_{i=1}^{N_u} \in [\mathbb{R}^{N_u}]^2,$$
	$$\vec{p} = \big(p_j\big)_{j=1}^{N_p} \in \mathbb{R}^{N_p} \; \text{ and } \; \vec{T} = \big(T_k\big)_{k=1}^{N_T} \in \mathbb{R}^{N_T}.$$

	\vspace{5pt}
	Considering $N_h = 2N_u + N_p + N_T$, we can define the global vector of unknowns as:
	\begin{equation*}
		\vec{U} = \big(\vec{u}, \vec{v}, \vec{p}, \vec{T}) \in \mathbb{R}^{N_h}.
	\end{equation*}
	and $F:\mathbb{R}^{N_h} \to \mathbb{R}^{N_h}$ the nonlinear operator associated to the weak formulation \eqref{eq:weak_pb}.
\end{frame}

\begin{frame}{Newton method}
	We want to solve the non linear system: %\hfill \tiny $N_h$ : number of degrees of freedom.

    \normalsize
    \vspace{-10pt}
    \begin{equation*}
        % \label{eq:nonlinear}
        F(\vec{U}) = 0 
    \end{equation*}

    \vspace{-2pt}
    with $F:\mathbb{R}^{N_h} \to \mathbb{R}^{N_h}$ a non linear operator and $\vec{U}\in \mathbb{R}^{N_h}$ the unknown vector.

	\setcounter{algocf}{0}
    \begin{center}
        \small
        \begin{minipage}{0.9\linewidth}
            \begin{algorithm}[H]
                \SetAlgoLined
                \caption{Newton's algorithm \citep{newton_accel_2025}}
                \textbf{Initialization step:} set $\vec{U}^{(0)} = \vec{U}_0$\;
                \For{\( k \ge 0 \)}{
                    Solve the linear system \( F(\vec{U}^{(k)}) + F'(\vec{U}^{(k)}) \delta^{(k+1)} = 0 \) for \( \delta^{(k+1)} \)\;
                    Update \( \vec{U}^{(k+1)} = \vec{U}^{(k)} + \delta^{(k+1)} \)\;
                }
            \end{algorithm}
        \end{minipage}
    \end{center}

	\uncover<2>{\textbf{Natural initialization} : 
	$$\vec{U}_0 = \big(\bm{0}_{N_u}, \bm{0}_{N_u}, \bm{0}_{N_p}, \vec{T}_0\big)$$
	where for $i=1,\ldots,N_T$,
	$$(\vec{T}_0)_i = g(\bm{x}^{(i)}) = 1 - (x^{(i)}+1)$$
	with $\bm{x}^{(i)}=\big(x^{(i)},y^{(i)}\big)$ the $i$-th dofs coordinates.}
\end{frame}

\begin{frame}{Initialization }

	% \only<3>{\textbf{Standard initialization} :\\
	% Denoting $U^{(0)}$ the initial guess, we can use a constant value for the initialization, i.e. $U^{(0)} = U_0$.}

	% \vspace{5pt}
	% \textbf{DeepPhysics version:} \citep{odot_deepphysics_2021} \\
	% Initialization with a PINN solution $U^{(0)}=U_\theta$.
	% }

    % \vspace{5pt}
    % \textbf{Standard version:} \\
    % Initialization with a constant value $u_0$. For instance, $u_0=1$.

    % \vspace{5pt}
    % \textbf{DeepPhysics version:} \citep{odot_deepphysics_2021} \\
    % Initialization with a PINN solution $u_0=u_\theta$.
\end{frame}